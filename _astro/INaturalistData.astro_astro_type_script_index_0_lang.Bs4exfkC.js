const e=document.getElementById("inaturalist-data"),r=document.getElementById("search-input"),u=document.getElementById("search-button"),o=document.getElementById("image-modal"),p=document.getElementById("modal-image"),g=document.getElementById("modal-caption"),h=document.getElementsByClassName("close")[0];if(e&&r&&u&&o&&p&&g&&h){const y=e.dataset.perPage||"5",d=e.dataset.taxonId,f=e.dataset.searchType||"general";async function c(t=""){try{let a=`https://api.inaturalist.org/v1/observations?per_page=${y}&order=desc&order_by=created_at`;d&&(a+=`&taxon_id=${d}`),t&&(f==="species"?a+=`&taxon_name=${encodeURIComponent(t)}`:a+=`&q=${encodeURIComponent(t)}`);const m=await(await fetch(a)).json();if(e.innerHTML="",m.results.length===0){e.innerHTML="No results found.";return}const i=document.createElement("div");i.className="observation-grid",m.results.forEach(n=>{const l=n.species_guess||n.taxon?.preferred_common_name||n.taxon?.name||"Unknown Species",s=document.createElement("div");s.className="observation-item",s.innerHTML=`
            <img src="${n.photos[0]?.url||""}" alt="${l}" loading="lazy" class="thumbnail">
            <div class="observation-info">
              <h3>${l}</h3>
              <p>Observed on: ${new Date(n.observed_on).toLocaleDateString()}</p>
            </div>
          `,i.appendChild(s),s.querySelector(".thumbnail").addEventListener("click",()=>{o.style.display="block",p.src=n.photos[0]?.large_url||"",g.innerHTML=`${l}<br>Observed on: ${new Date(n.observed_on).toLocaleDateString()}`})}),e.appendChild(i)}catch(a){console.error("Error fetching iNaturalist data:",a),e.innerHTML="Error loading iNaturalist data."}}u.addEventListener("click",()=>{c(r.value)}),r.addEventListener("keypress",t=>{t.key==="Enter"&&c(r.value)}),h.onclick=function(){o.style.display="none"},window.onclick=function(t){t.target==o&&(o.style.display="none")},c()}else console.error("Could not find necessary elements for iNaturalist data");
